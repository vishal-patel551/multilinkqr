<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Opening Your Links – MultiLinkQR Landing Page</title>

    <!-- SEO -->
    <meta name="description"
          content="MultiLinkQR landing page. Open multiple HTTPS links from a single QR code scan, with buttons and link preview cards as a fallback.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="index,follow">

    <!-- Open Graph -->
    <meta property="og:title" content="Opening Your Links – MultiLinkQR" />
    <meta property="og:description"
          content="This MultiLinkQR page automatically opens multiple links from one QR code scan. Use the buttons or preview cards below if pop-ups are blocked." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://multilinkqr.com/multi.html" />
    <meta property="og:image" content="https://multilinkqr.com/og-image.png" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Opening Your Links – MultiLinkQR" />
    <meta name="twitter:description"
          content="Landing page for MultiLinkQR codes. Automatically opens multiple HTTPS links in new tabs, with buttons and link previews as backup." />
    <meta name="twitter:image" content="https://multilinkqr.com/og-image.png" />

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TJ54LBGSDP"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-TJ54LBGSDP');
    </script>
    <style>
        :root {
            --ml-primary: #0d6efd;
            --ml-primary-soft: #e7f1ff;
        }

        body {
            background-color: #f8f9fa;
        }

        .brand-logo {
            font-weight: 700;
            letter-spacing: 0.03em;
        }

        .page-hero {
            background: linear-gradient(135deg, #e7f1ff, #d0e0ff);
            border-bottom: 1px solid #c5d8ff;
        }

        .page-hero-text {
            color: #12345a;
        }

        .status-pill {
            display: inline-flex;
            align-items: center;
            gap: 0.35rem;
            padding: 0.15rem 0.65rem;
            border-radius: 999px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.09em;
            background-color: #e9f5ff;
            color: #0b5ed7;
        }

        .preview-card {
            border-radius: 0.75rem;
            border: 1px solid #dee2e6;
            padding: 0.75rem 1rem;
            background: #ffffff;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .preview-favicon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            flex-shrink: 0;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 600;
            color: #495057;
        }

        .preview-url {
            word-break: break-all;
        }

        footer {
            margin-top: 3rem;
            padding: 1.5rem 0;
            background: #ffffff;
            border-top: 1px solid #e5e5e5;
            font-size: 0.9rem;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container">
            <a class="navbar-brand brand-logo" href="index.html">
                <span class="text-primary">Multi</span>LinkQR
            </a>
        </div>
    </nav>

    <!-- HERO -->
    <section class="page-hero py-4">
        <div class="container">
            <div class="row align-items-center g-3">
                <div class="col-lg-8 page-hero-text">
                    <div class="status-pill mb-2">
                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                        Opening your links
                    </div>
                    <h1 id="pageTitle" class="h4 mb-1">Opening your links…</h1>
                    <p id="pageSubtitle" class="mb-0">
                        This page belongs to a MultiLinkQR code and is responsible for opening all of the links connected to it.
                    </p>
                </div>
                <div class="col-lg-4 text-lg-end text-muted small">
                    Powered by MultiLinkQR – one QR code, multiple links.
                </div>
            </div>
        </div>
    </section>

    <!-- MAIN -->
    <main class="py-4">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="card shadow-sm">
                        <div class="card-body p-4 p-md-5">
                            <p id="statusArea" class="text-muted mb-3">
                                We’re trying to open all your links in new tabs. If your browser blocks pop-ups,
                                you can use the buttons or preview cards below.
                            </p>

                            <div id="errorArea"></div>

                            <div id="expiredMessage" class="alert alert-warning d-none">
                                <strong>This QR code has expired.</strong>
                                Please contact the owner for a new code or updated link.
                            </div>

                            <!-- VIEW CONTROLS -->
                            <div id="controls" class="mt-3 mb-3 d-none">
                                <div class="d-flex flex-wrap align-items-center gap-2">
                                    <label class="form-label fw-semibold mb-0">View options:</label>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <button type="button" class="btn btn-outline-primary" id="btnViewOpen">Open all links</button>
                                        <button type="button" class="btn btn-outline-primary" id="btnViewButtons">Buttons</button>
                                        <button type="button" class="btn btn-outline-primary" id="btnViewPreview">Preview cards</button>
                                    </div>
                                </div>
                            </div>

                            <!-- BUTTON LIST -->
                            <div id="buttonsView" class="mt-3 d-none"></div>

                            <!-- PREVIEW CARDS -->
                            <div id="previewView" class="mt-3 d-none"></div>

                            <hr class="my-4">

                            <div class="d-flex flex-wrap justify-content-between align-items-center gap-2">
                                <p class="small text-muted mb-0">
                                    Want to build your own page like this with multiple links?
                                </p>
                                <a href="generator.html" class="btn btn-outline-secondary btn-sm">
                                    Create your own multi-link QR
                                </a>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- FOOTER -->
    <footer>
        <div class="container d-flex flex-wrap justify-content-between align-items-center">
            <div>© <span id="yearSpan"></span> MultiLinkQR – Multi-link QR code generator.</div>
            <div>
                <a href="privacy-policy.html" class="me-3">Privacy Policy</a>
                <a href="terms.html">Terms</a>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
    function getParam(name) {
        const params = new URLSearchParams(window.location.search);
        return params.get(name);
    }

    function showError(message) {
        $("#errorArea").html(
            '<div class="alert alert-danger" role="alert">' + message + '</div>'
        );
    }

    function validateHttps(url) {
        return /^https:\/\/.+/i.test(url.trim());
    }

    function getDomain(url) {
        try {
            const u = new URL(url);
            return u.hostname;
        } catch (e) {
            return url;
        }
    }

    function createFaviconUrl(url) {
        try {
            const u = new URL(url);
            return u.origin + "/favicon.ico";
        } catch (e) {
            return null;
        }
    }

    function renderButtons(links, primaryColor) {
        const container = $("#buttonsView");
        container.empty();
        links.forEach(function (item, idx) {
            const label = item.label || ("Link " + (idx + 1));
            container.append(
                '<a href="' + item.url + '" target="_blank" rel="noopener noreferrer"' +
                ' class="btn btn-primary w-100 mb-2"' +
                ' style="background-color:' + primaryColor + ';border-color:' + primaryColor + '">' +
                label +
                '</a>'
            );
        });
    }

    function renderPreviewCards(links) {
        const container = $("#previewView");
        container.empty();
        links.forEach(function (item, idx) {
            const label = item.label || ("Link " + (idx + 1));
            const domain = getDomain(item.url);
            const favicon = createFaviconUrl(item.url);
            const firstLetter = (domain && domain[0]) ? domain[0].toUpperCase() : "?";

            const faviconHtml = favicon
                ? '<img src="' + favicon + '" alt="icon" onerror="this.style.display=\'none\'" style="width:32px;height:32px;border-radius:8px;">'
                : '<span>' + firstLetter + '</span>';

            container.append(
                '<div class="preview-card">' +
                    '<div class="preview-favicon">' + faviconHtml + '</div>' +
                    '<div>' +
                        '<div class="fw-semibold">' + label + '</div>' +
                        '<div class="small text-muted preview-url">' +
                            '<a href="' + item.url + '" target="_blank" rel="noopener noreferrer">' +
                                item.url +
                            '</a>' +
                        '</div>' +
                    '</div>' +
                '</div>'
            );
        });
    }

    function openAllLinks(links) {
        links.forEach(function (item) {
            window.open(item.url, "_blank");
        });
    }

    $(function () {
        $("#yearSpan").text(new Date().getFullYear());

        const encoded = getParam("d");
        if (!encoded) {
            showError("No data found in the URL. Please scan a valid MultiLinkQR code or use the correct link.");
            $("#statusArea").text("Unable to open links.");
            $("#pageSubtitle").text("The QR code data is missing from this URL.");
            return;
        }

        let payload;
        try {
            const jsonStr = decodeURIComponent(escape(atob(encoded)));
            payload = JSON.parse(jsonStr);
        } catch (e) {
            console.error(e);
            showError("The data in the URL is invalid or corrupted.");
            $("#statusArea").text("Unable to open links.");
            $("#pageSubtitle").text("We could not decode the information embedded in this QR code.");
            return;
        }

        const links = (payload && Array.isArray(payload.links))
            ? payload.links.filter(l => validateHttps(l.url))
            : [];

        if (links.length === 0) {
            showError("No valid HTTPS links were found in this MultiLinkQR code.");
            $("#statusArea").text("Unable to open links.");
            $("#pageSubtitle").text("The QR code did not contain any valid HTTPS URLs.");
            return;
        }

        const now = Date.now();
        if (payload.exp && now > payload.exp) {
            $("#expiredMessage").removeClass("d-none");
            $("#statusArea").text("This QR code is expired.");
            $("#pageSubtitle").text("The expiry date for this MultiLinkQR code has passed.");
            return;
        }

        const title = payload.title || "Your links are ready";
        $("#pageTitle").text(title);

        const style = payload.style || {};
        const primaryColor = style.color || "#0d6efd";
        const bg = style.bg || "#f8f9fa";

        if (bg === "#000000") {
            $("body").css("background-color", "#000000");
            $(".card").addClass("bg-dark text-light");
        }

        $("#controls").removeClass("d-none");
        $("#buttonsView").removeClass("d-none");

        renderButtons(links, primaryColor);
        renderPreviewCards(links);
        $(".status-pill").hide();

        const mode = payload.mode || "auto";

        if (mode === "auto") {
            $("#statusArea").text("Trying to open all links in new tabs. If pop-ups are blocked, use the buttons or previews below.");
            openAllLinks(links);
        } else {
            $("#statusArea").text("Use the buttons or preview cards below to open your links.");
        }

        // View toggles
        $("#btnViewOpen").on("click", function () {
            openAllLinks(links);
        });
        $("#btnViewButtons").on("click", function () {
            $("#buttonsView").removeClass("d-none");
            $("#previewView").addClass("d-none");
        });
        $("#btnViewPreview").on("click", function () {
            $("#previewView").removeClass("d-none");
            $("#buttonsView").addClass("d-none");
        });
    });
    </script>
</body>
</html>
